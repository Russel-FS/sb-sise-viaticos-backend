<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Iniciar Sesión - ISS Viáticos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
      (function () {
        const savedTheme = localStorage.getItem("theme");
        const prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        if (savedTheme === "dark" || (!savedTheme && prefersDark)) {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>
    <th:block th:include="~{fragments/theme :: themeStyles}"></th:block>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              apple: {
                blue: "#0071e3",
                bg: "#f5f5f7",
                secondary: "#86868b",
              },
            },
          },
        },
      };
    </script>
    <style>
      body {
        background-color: #f5f5f7;
        color: #1d1d1f;
        transition: background-color 0.3s ease;
      }
      .glass-card {
        background: rgba(255, 255, 255, 0.82);
        backdrop-filter: saturate(180%) blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.3);
      }
      /* dark mode */
      .dark body {
        background-color: #000000;
        color: #f5f5f7;
      }
      .dark .glass-card {
        background: rgba(28, 28, 30, 0.82);
        border: 1px solid rgba(255, 255, 255, 0.08);
      }
      .dark input {
        background-color: #1c1c1e !important;
        border-color: #3a3a3c !important;
        color: white !important;
      }
    </style>
  </head>
  <body class="antialiased flex items-center justify-center min-h-screen">
    <!-- boton toggle en login -->
    <div class="fixed top-8 right-8">
      <button
        onclick="toggleTheme()"
        class="w-10 h-10 rounded-full flex items-center justify-center transition-all bg-white dark:bg-white/10 shadow-sm border border-gray-200 dark:border-white/10"
      >
        <i
          data-lucide="sun"
          class="w-5 h-5 text-yellow-400 hidden dark:block"
        ></i>
        <i
          data-lucide="moon"
          class="w-5 h-5 text-gray-600 block dark:hidden"
        ></i>
      </button>
    </div>

    <div
      class="w-full max-w-[400px] p-8 animate-in fade-in zoom-in duration-500"
    >
      <div class="text-center mb-10">
        <h1 class="text-3xl font-bold tracking-tight">Iniciar sesión.</h1>
        <p class="text-apple-secondary mt-2 font-medium">
          Ingeniería y Servicios del Sur S.A.C.
        </p>
      </div>

      <div class="glass-card p-8 rounded-[28px] shadow-2xl shadow-black/5">
        <form th:action="@{/login}" method="post" class="space-y-4">
          <div>
            <input
              type="text"
              name="username"
              placeholder="Correo o DNI"
              class="w-full px-5 py-4 bg-white border border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-apple-blue/10 focus:border-apple-blue transition-all"
            />
          </div>
          <div>
            <input
              type="password"
              name="password"
              placeholder="Contraseña"
              class="w-full px-5 py-4 bg-white border border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-apple-blue/10 focus:border-apple-blue transition-all"
            />
          </div>

          <div
            th:if="${param.error}"
            class="p-4 bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-900/30 rounded-2xl mb-4"
          >
            <p
              class="text-red-500 dark:text-red-400 text-xs text-center font-bold"
            >
              Usuario o contraseña incorrectos
            </p>
          </div>

          <button
            type="submit"
            class="w-full py-4 bg-apple-blue text-white font-bold rounded-2xl hover:bg-[#0077ed] transition-all active:scale-[0.98] mt-6 shadow-lg shadow-apple-blue/20"
          >
            Continuar
          </button>
        </form>
      </div>
    </div>

    <script th:inline="javascript">
      lucide.createIcons();
    </script>
    <th:block th:replace="~{fragments/theme :: themeScript}"></th:block>
  </body>
</html>
