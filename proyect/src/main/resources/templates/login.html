<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Iniciar Sesión - ISS Viáticos</title>

    <!-- Fuentes y Recursos -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Inter:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Configuración del Tema -->
    <script>
      (function () {
        const savedTheme = localStorage.getItem("theme");
        const prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        if (savedTheme === "dark" || (!savedTheme && prefersDark)) {
          document.documentElement.classList.add("dark");
        }
      })();
    </script>
    <th:block th:replace="~{fragments/theme :: themeStyles}"></th:block>

    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            fontFamily: {
              serif: ['"Instrument Serif"', "serif"],
              sans: ['"Inter"', "sans-serif"],
            },
            colors: {
              background: { light: "#F9F8F6", dark: "#0F1115" },
            },
            animation: {
              gradient: "gradient 15s ease infinite",
              "slide-up":
                "slide-up 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards",
            },
            keyframes: {
              gradient: {
                "0%, 100%": { "background-position": "0% 50%" },
                "50%": { "background-position": "100% 50%" },
              },
              "slide-up": {
                "0%": { transform: "translateY(20px)", opacity: "0" },
                "100%": { transform: "translateY(0)", opacity: "1" },
              },
            },
          },
        },
      };
    </script>

    <style>
      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(-45deg, #f3f4f6, #e5e7eb, #d1d5db, #f3f4f6);
        background-size: 400% 400%;
        animation: gradient 15s ease infinite;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .dark body {
        background: linear-gradient(-45deg, #0f1115, #1c1c1e, #111827, #0f1115);
      }

      .login-card {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.05);
      }
      .dark .login-card {
        background: rgba(28, 28, 30, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
      }

      .input-premium {
        width: 100%;
        padding: 1rem 1.25rem;
        background-color: white; /* Más contraste */
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        font-size: 0.95rem;
        font-weight: 500;
        transition: all 0.2s ease-in-out;
        outline: none;
        color: #1f2937;
      }
      .dark .input-premium {
        background-color: rgba(255, 255, 255, 0.05);
        border-color: rgba(255, 255, 255, 0.1);
        color: white;
      }
      .input-premium:focus {
        border-color: #2d3b2d;
        box-shadow: 0 0 0 4px rgba(45, 59, 45, 0.05);
        transform: translateY(-1px);
      }
      .dark .input-premium:focus {
        border-color: #d8e2dc;
        box-shadow: 0 0 0 4px rgba(216, 226, 220, 0.1);
      }
    </style>
  </head>
  <body class="p-4">
    <!-- Theme Toggle (Floating) -->
    <div class="fixed top-6 right-6 z-50">
      <button
        onclick="toggleTheme()"
        class="w-10 h-10 rounded-full flex items-center justify-center bg-white/50 dark:bg-black/20 backdrop-blur-md border border-white/20 hover:scale-110 transition-all shadow-lg"
      >
        <i
          data-lucide="sun"
          class="w-4 h-4 text-gray-600 hidden dark:block"
        ></i>
        <i
          data-lucide="moon"
          class="w-4 h-4 text-gray-800 block dark:hidden"
        ></i>
      </button>
    </div>

    <!-- Login Card -->
    <div
      class="login-card w-full max-w-[420px] rounded-[32px] p-8 md:p-12 animate-slide-up relative overflow-hidden"
    >
      <!-- Decoración sutil -->
      <div
        class="absolute -top-20 -right-20 w-40 h-40 bg-blue-500/10 rounded-full blur-3xl pointer-events-none"
      ></div>
      <div
        class="absolute -bottom-20 -left-20 w-40 h-40 bg-purple-500/10 rounded-full blur-3xl pointer-events-none"
      ></div>

      <!-- Header -->
      <div class="text-center mb-10 relative z-10">
        <div
          class="w-14 h-14 mx-auto bg-gray-900 dark:bg-white text-white dark:text-black rounded-2xl flex items-center justify-center shadow-xl mb-6"
        >
          <i data-lucide="layers" class="w-7 h-7"></i>
        </div>
        <h1
          class="text-4xl font-serif italic text-gray-900 dark:text-white mb-2"
        >
          Bienvenido
        </h1>
        <p class="text-sm text-gray-500 dark:text-gray-400">
          Ingresa a tu cuenta para continuar
        </p>
      </div>

      <!-- Form -->
      <form th:action="@{/login}" method="post" class="space-y-6 relative z-10">
        <div class="space-y-4">
          <div>
            <label
              class="block text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-1.5 ml-1"
              >Usuario</label
            >
            <div class="relative">
              <input
                type="text"
                name="username"
                required
                placeholder="ej. juan.perez"
                class="input-premium pl-11"
              />
              <i
                data-lucide="user"
                class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"
              ></i>
            </div>
          </div>

          <div>
            <label
              class="block text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-widest mb-1.5 ml-1"
              >Contraseña</label
            >
            <div class="relative">
              <input
                type="password"
                name="password"
                required
                placeholder="••••••••"
                class="input-premium pl-11"
              />
              <i
                data-lucide="lock"
                class="absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"
              ></i>
            </div>
          </div>
        </div>

        <!-- Error mensaje -->
        <div
          th:if="${param.error}"
          class="p-3 rounded-xl bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-900/30 flex items-center gap-3 text-red-600 dark:text-red-400 text-sm animate-in fade-in slide-in-from-top-2"
        >
          <i data-lucide="alert-circle" class="w-4 h-4 shrink-0"></i>
          <span class="font-medium">Credenciales incorrectas</span>
        </div>

        <!-- Submit Boton -->
        <button
          type="submit"
          class="w-full py-4 bg-gray-900 dark:bg-white text-white dark:text-black font-bold rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 active:translate-y-0 active:shadow-md transition-all duration-300 flex items-center justify-center gap-2 group"
        >
          <span>Iniciar Sesión</span>
          <i
            data-lucide="arrow-right"
            class="w-4 h-4 group-hover:translate-x-1 transition-transform"
          ></i>
        </button>
      </form>

      <!-- Footer -->
      <div class="mt-8 text-center">
        <p class="text-xs text-gray-400 uppercase tracking-widest">
          ISS Viáticos &copy; 2025
        </p>
      </div>
    </div>

    <script th:inline="javascript">
      lucide.createIcons();
      function toggleTheme() {
        if (document.documentElement.classList.contains("dark")) {
          document.documentElement.classList.remove("dark");
          localStorage.setItem("theme", "light");
        } else {
          document.documentElement.classList.add("dark");
          localStorage.setItem("theme", "dark");
        }
      }
    </script>
    <th:block th:replace="~{fragments/theme :: themeScript}"></th:block>
  </body>
</html>
